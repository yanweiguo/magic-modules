<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Run tests # Before you begin # Generate the modified provider(s)
Set up application default credentials for Terraform
gcloud auth application-default login export GOOGLE_USE_DEFAULT_CREDENTIALS=TRUE Set the following environment variables:
export GOOGLE_USE_DEFAULT_CREDENTIALS=TRUE export GOOGLE_PROJECT=PROJECT_ID export GOOGLE_REGION=us-central1 export GOOGLE_ZONE=us-central1-a Replace PROJECT_ID with the ID of the Google Cloud project you are using for testing.
Optional: Some tests may require additional variables to be set, such as:
GOOGLE_ORG GOOGLE_BILLING_ACCOUNT Run automated tests # GA Provider Run unit tests and linters"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Run tests"><meta property="og:description" content="Run tests # Before you begin # Generate the modified provider(s)
Set up application default credentials for Terraform
gcloud auth application-default login export GOOGLE_USE_DEFAULT_CREDENTIALS=TRUE Set the following environment variables:
export GOOGLE_USE_DEFAULT_CREDENTIALS=TRUE export GOOGLE_PROJECT=PROJECT_ID export GOOGLE_REGION=us-central1 export GOOGLE_ZONE=us-central1-a Replace PROJECT_ID with the ID of the Google Cloud project you are using for testing.
Optional: Some tests may require additional variables to be set, such as:
GOOGLE_ORG GOOGLE_BILLING_ACCOUNT Run automated tests # GA Provider Run unit tests and linters"><meta property="og:type" content="article"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/develop/run-tests/"><meta property="article:section" content="develop"><meta property="article:modified_time" content="2023-07-25T21:30:36+00:00"><title>Run tests | Magic Modules</title><link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png type=image/x-icon><link rel=stylesheet href=/magic-modules/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz+OQteg=" crossorigin=anonymous><script defer src=/magic-modules/flexsearch.min.js></script>
<script defer src=/magic-modules/en.search.min.683ab4de52a836795b617f968f15c0cd44abd1c812015cd71aaa7dfeb1f8cdf3.js integrity="sha256-aDq03lKoNnlbYX+WjxXAzUSr0cgSAVzXGqp9/rH4zfM=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><span>Get started</span><ul><li><a href=/magic-modules/get-started/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/get-started/how-magic-modules-works/>How Magic Modules works</a></li><li><a href=/magic-modules/get-started/contributing/>Contributing</a></li><li><a href=/magic-modules/get-started/provider-documentation/>Provider documentation</a></li></ul></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/resource/>Add or modify a resource</a></li><li><a href=/magic-modules/develop/add-mmv1-test/>Add an MMv1 test</a></li><li><a href=/magic-modules/develop/add-handwritten-test/>Add a handwritten test</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a datasource</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource-documentation/>Add datasource documentation</a></li><li><a href=/magic-modules/develop/promote-to-ga/>Promote to GA</a></li><li><a href=/magic-modules/develop/run-tests/ class=active>Run tests</a></li><li><a href=/magic-modules/develop/make-a-breaking-change/>Make a breaking change</a></li></ul></li><li><a href=/magic-modules/best-practices/>Best practices</a><ul></ul></li><li><span>Contribute</span><ul><li><a href=/magic-modules/contribute/release-notes/>Write release notes</a></li><li><a href=/magic-modules/contribute/review-pr/>Review a PR</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource.rb target=_blank rel=noopener>Resource YAML reference ↗</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/type.rb target=_blank rel=noopener>Field YAML reference ↗</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource/iam_policy.rb target=_blank rel=noopener>IAM policy YAML reference ↗</a></li><li><a href=/magic-modules/reference/breaking-change-detector/>Breaking change detector</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Run tests</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before you begin</a></li><li><a href=#run-automated-tests>Run automated tests</a></li><li><a href=#optional-test-with-different-terraform-versions>Optional: Test with different <code>terraform</code> versions</a></li><li><a href=#optional-test-manually>Optional: Test manually</a><ul><li><a href=#build-provider>Build provider</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=run-tests>Run tests
<a class=anchor href=#run-tests>#</a></h1><h2 id=before-you-begin>Before you begin
<a class=anchor href=#before-you-begin>#</a></h2><p><a href=https://googlecloudplatform.github.io/magic-modules/get-started/generate-providers/>Generate the modified provider(s)</a></p><ol><li><p>Set up application default credentials for Terraform</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gcloud auth application-default login
</span></span><span style=display:flex><span>export GOOGLE_USE_DEFAULT_CREDENTIALS<span style=color:#f92672>=</span>TRUE
</span></span></code></pre></div></li><li><p>Set the following environment variables:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export GOOGLE_USE_DEFAULT_CREDENTIALS<span style=color:#f92672>=</span>TRUE
</span></span><span style=display:flex><span>export GOOGLE_PROJECT<span style=color:#f92672>=</span>PROJECT_ID
</span></span><span style=display:flex><span>export GOOGLE_REGION<span style=color:#f92672>=</span>us-central1
</span></span><span style=display:flex><span>export GOOGLE_ZONE<span style=color:#f92672>=</span>us-central1-a
</span></span></code></pre></div><p>Replace <code>PROJECT_ID</code> with the ID of the Google Cloud project you are using for testing.</p></li><li><p>Optional: Some tests may require additional variables to be set, such as:</p><pre tabindex=0><code>GOOGLE_ORG
GOOGLE_BILLING_ACCOUNT
</code></pre></li></ol><h2 id=run-automated-tests>Run automated tests
<a class=anchor href=#run-automated-tests>#</a></h2><div class=book-tabs><input type=radio class=toggle name=tabs-version id=tabs-version-0 checked>
<label for=tabs-version-0>GA Provider</label><div class="book-tabs-content markdown-inner"><ol><li><p>Run unit tests and linters</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make test
</span></span><span style=display:flex><span>make lint
</span></span></code></pre></div></li><li><p>Run acceptance tests for only modified resources. (Full test runs can take over 9 hours.) See <a href=https://pkg.go.dev/cmd/go#hdr-Testing_flags>Go&rsquo;s documentation</a> for more information about <code>-run</code> and other flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool&#39;</span>
</span></span></code></pre></div></li><li><p>Optional: Save verbose test output to a file for analysis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_LOG<span style=color:#f92672>=</span>TRACE make testacc TEST<span style=color:#f92672>=</span>./google TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic&#39;</span> &gt; output.log
</span></span></code></pre></div></li><li><p>Optional: Debug tests with <a href=https://github.com/go-delve/delve>Delve</a>. See <a href=https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_test.md><code>dlv test</code> documentation</a> for information about available flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd google
</span></span><span style=display:flex><span>TF_ACC<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> dlv test -- --test.v --test.run TestAccComputeRegionBackendService_withCdnPolicy
</span></span></code></pre></div></li></ol></div><input type=radio class=toggle name=tabs-version id=tabs-version-1>
<label for=tabs-version-1>Beta Provider</label><div class="book-tabs-content markdown-inner"><ol><li><p>Run unit tests and linters</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make test
</span></span><span style=display:flex><span>make lint
</span></span></code></pre></div></li><li><p>Run acceptance tests for only modified resources. (Full test runs can take over 9 hours.) See <a href=https://pkg.go.dev/cmd/go#hdr-Testing_flags>Go&rsquo;s documentation</a> for more information about <code>-run</code> and other flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>make testacc TEST<span style=color:#f92672>=</span>./google-beta TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool&#39;</span>
</span></span></code></pre></div></li><li><p>Optional: Save verbose test output to a file for analysis.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_LOG<span style=color:#f92672>=</span>TRACE make testacc TEST<span style=color:#f92672>=</span>./google-beta TESTARGS<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;-run=TestAccContainerNodePool_basic&#39;</span> &gt; output.log
</span></span></code></pre></div></li><li><p>Optional: Debug tests with <a href=https://github.com/go-delve/delve>Delve</a>. See <a href=https://github.com/go-delve/delve/blob/master/Documentation/usage/dlv_test.md><code>dlv test</code> documentation</a> for information about available flags.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cd google-beta
</span></span><span style=display:flex><span>TF_ACC<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> dlv test -- --test.v --test.run TestAccComputeRegionBackendService_withCdnPolicy
</span></span></code></pre></div></li></ol></div></div><h2 id=optional-test-with-different-terraform-versions>Optional: Test with different <code>terraform</code> versions
<a class=anchor href=#optional-test-with-different-terraform-versions>#</a></h2><p>Tests will use whatever version of the <code>terraform</code> binary is found on your <code>PATH</code>. If you are testing a change that you know only impacts certain <code>terraform</code> versions, follow these steps:</p><ol><li><p>Install <a href=https://github.com/tfutils/tfenv><code>tfenv</code></a>.</p></li><li><p>Install the version of <code>terraform</code> you want to test.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tfenv install VERSION
</span></span></code></pre></div><p>Replace <code>VERSION</code> with the version you want to test.</p></li><li><p>Run automated tests following the <a href=https://googlecloudplatform.github.io/magic-modules/develop/run-tests/#run-automated-tests>earlier section</a>.</p></li></ol><h2 id=optional-test-manually>Optional: Test manually
<a class=anchor href=#optional-test-manually>#</a></h2><p>Sometimes, for example for manual testing, you may want to build the provider from source and use it with <code>terraform</code>.</p><h3 id=build-provider>Build provider
<a class=anchor href=#build-provider>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>## ga provider</span>
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google
</span></span><span style=display:flex><span>make build
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## beta provider</span>
</span></span><span style=display:flex><span>cd $GOPATH/src/github.com/hashicorp/terraform-provider-google-beta
</span></span><span style=display:flex><span>make build
</span></span></code></pre></div><div class=book-tabs><input type=radio class=toggle name=tabs-built-provider id=tabs-built-provider-0 checked>
<label for=tabs-built-provider-0>Developer overrides</label><div class="book-tabs-content markdown-inner"><p>In the sections below we describe how to create a Terraform CLI configuration file, and how to make the CLI use the file via an environment variable.</p><h3 id=create-developer-overrides-file>Create developer overrides file
<a class=anchor href=#create-developer-overrides-file>#</a></h3><p>Choose your architecture below.</p><div class=book-tabs><input type=radio class=toggle name=tabs-setup id=tabs-setup-0 checked>
<label for=tabs-setup-0>Mac (ARM64 and AMD64), Linux AMD64</label><div class="book-tabs-content markdown-inner"><ol><li><p>Find the location where built provider binaries are created. To do this, run this command and make a note of the path value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>go env GOBIN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## If the above returns nothing, then run the command below and add &#34;/bin&#34; to the end of the output path.</span>
</span></span><span style=display:flex><span>go env GOPATH
</span></span></code></pre></div></li><li><p>Create an empty configuration file.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>## create an empty file</span>
</span></span><span style=display:flex><span>touch ~/tf-dev-override.tfrc
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## open the file with a text editor of your choice, e.g:</span>
</span></span><span style=display:flex><span>vi ~/tf-dev-override.tfrc
</span></span></code></pre></div><p>Open the empty file with a text editor and paste in these contents:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>provider_installation</span> {<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # Developer overrides will stop Terraform from downloading the listed
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # providers their origin provider registries.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>dev_overrides</span> {
</span></span><span style=display:flex><span>      &#34;hashicorp/google&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH/bin&#34;</span>
</span></span><span style=display:flex><span>      &#34;hashicorp/google-beta&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH/bin&#34;</span>
</span></span><span style=display:flex><span>  }<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # For all other providers, install them directly from their origin provider
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # registries as normal. If you omit this, Terraform will _only_ use
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # the dev_overrides block, and so no other providers will be available.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>direct</span> {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>Edit the file to replace <code>GO_BIN_PATH</code> with the path you saved from the first step, making sure to keep <code>/bin</code> at the end of the path.</p><p><strong>Please note</strong>: the <em>full</em> path is required and environment variables cannot be used. For example, <code>"/Users/UserName/go/bin"</code> is a valid path for a user called <code>UserName</code>, but <code>"~/go/bin"</code> or <code>"$HOME/go/bin"</code> will not work.</p></li><li><p>Save the file.</p></li></ol></div><input type=radio class=toggle name=tabs-setup id=tabs-setup-1>
<label for=tabs-setup-1>Windows (Vista and above)</label><div class="book-tabs-content markdown-inner"><ol><li><p>Find the location where built provider binaries are created. To do this, run this command and make a note of the path value:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo %GOPATH%
</span></span></code></pre></div></li><li><p>Create an empty configuration file in the <code>%APPDATA%</code> directory (use <code>$env:APPDATA</code> in PowerShell to find its location on your system).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e>## create an empty file</span>
</span></span><span style=display:flex><span>type nul &gt; <span style=color:#e6db74>&#34;</span>$($env:APPDATA)<span style=color:#e6db74>\tf-dev-override.tfrc&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## open the file with a text editor of your choice, e.g:</span>
</span></span><span style=display:flex><span>notepad <span style=color:#e6db74>&#34;</span>$($env:APPDATA)<span style=color:#e6db74>\tf-dev-override.tfrc&#34;</span>
</span></span></code></pre></div><p>Open the empty file with a text editor and paste in these contents:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-hcl data-lang=hcl><span style=display:flex><span><span style=color:#66d9ef>provider_installation</span> {<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # Developer overrides will stop Terraform from downloading the listed
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # providers their origin provider registries.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>dev_overrides</span> {
</span></span><span style=display:flex><span>      &#34;hashicorp/google&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH\bin&#34;</span>
</span></span><span style=display:flex><span>      &#34;hashicorp/google-beta&#34; <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;GO_BIN_PATH\bin&#34;</span>
</span></span><span style=display:flex><span>  }<span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # For all other providers, install them directly from their origin provider
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # registries as normal. If you omit this, Terraform will _only_ use
</span></span></span><span style=display:flex><span><span style=color:#75715e>  # the dev_overrides block, and so no other providers will be available.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>direct</span> {}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></li><li><p>Edit the file to replace <code>GO_BIN_PATH</code> with the output you saved from the first step, making sure to keep <code>\bin</code> at the end of the path.</p><p><strong>Please note</strong>: The <em>full</em> path is required and environment variables cannot be used. For example, <code>C:\Users\UserName\go\bin</code> is a valid path for a user called <code>UserName</code>.</p></li><li><p>Save the file.</p></li></ol></div></div><p>This CLI configuration file you created in the steps above will allow Terraform to use the binaries generated by the <code>make build</code> commands in the <code>terraform-provider-google</code> and <code>terraform-provider-google-beta</code> repositories instead of downloading the latest versions.</p><h3 id=using-terraform-cli-developer-overrides>Using Terraform CLI developer overrides
<a class=anchor href=#using-terraform-cli-developer-overrides>#</a></h3><ol><li><p>Create a new directory and a <code>main.tf</code> file with your resource and its dependencies.</p></li><li><p>To make Terraform use the configuration file you created, you need to set the <code>TF_CLI_CONFIG_FILE</code> environment variable to the path to the configuration file (<a href=https://developer.hashicorp.com/terraform/cli/config/environment-variables#tf_cli_config_file>see the documentation here</a>).</p><p>Assuming that a configuration file was created at <code>~/tf-dev-override.tfrc</code>, you can either export the environment variable or set it explicitly for each <code>terraform</code> command. Note that you need to use the full path:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># either export the environment variable for your session</span>
</span></span><span style=display:flex><span>export TF_CLI_CONFIG_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/Users/UserName/tf-dev-override.tfrc&#34;</span>
</span></span><span style=display:flex><span>terraform plan
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># OR, set the environment variable value per command</span>
</span></span><span style=display:flex><span>TF_CLI_CONFIG_FILE<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/Users/UserName/tf-dev-override.tfrc&#34;</span> terraform plan
</span></span></code></pre></div></li><li><p>To check that the developer override is working, look for a warning near the start of the terminal output that looks like the example below. It is not necessary to run the terraform init command to use development overrides.</p><pre tabindex=0><code>│ Warning: Provider development overrides are in effect
│ 
│ The following provider development overrides are set in the CLI configuration:
│  - hashicorp/google in /Users/UserName/go/bin
│  - hashicorp/google-beta in /Users/UserName/go/bin
│ 
│ The behavior may therefore not match any released version of the provider and applying
│ changes may cause the state to become incompatible with published releases.
</code></pre></li><li><p>Apply your configuration.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>TF_LOG<span style=color:#f92672>=</span>DEBUG TF_LOG_PATH<span style=color:#f92672>=</span>output.log terraform apply
</span></span></code></pre></div></li></ol><blockquote class="book-hint info"><strong>Note:</strong> Developer overrides work without you needing to alter your Terraform configuration in any way.</blockquote><h3 id=download-production-providers>Download production providers
<a class=anchor href=#download-production-providers>#</a></h3><p>To stop using developer overrides, unset the <code>TF_CLI_CONFIG_FILE</code> environment variable or stop setting it in the commands you are executing.</p><p>This will then let Terraform resume normal behaviour of pulling published provider versions from the public Registry. Any version constraints in your Terraform configuration will come back into effect. Also, you may need to run <code>terraform init</code> to download the required version of the provider into your project directory if you haven&rsquo;t already.</p><h3 id=alternative-using-a-global-cli-configuration-file>Alternative: using a global CLI configuration file
<a class=anchor href=#alternative-using-a-global-cli-configuration-file>#</a></h3><p>If you do not want to use the <code>TF_CLI_CONFIG_FILE</code> environment variable, as described above, you can instead create a global version of the CLI configuration file. This configuration will be used automatically by Terraform. To do this, follow <a href=https://developer.hashicorp.com/terraform/cli/config/config-file#locations>the guidance in the official documentation</a>. For Windows, the file will be named <code>terraform.rc</code> and go in the <code>%APPDATA</code> directory. For all other systems, it will be named <code>.terraformrc</code> and go in the user&rsquo;s home directory.</p><p>In this scenario you will need to remember to edit this file to swap between using developer overrides and using the production provider versions.</p></div><input type=radio class=toggle name=tabs-built-provider id=tabs-built-provider-1>
<label for=tabs-built-provider-1>Filesystem mirrors (Terraform 0.13 and earlier)</label><div class="book-tabs-content markdown-inner"><p>Filesystem mirrors can used explicitly or implicitly by Terraform. Explicit filesystem mirrors can be <a href=https://developer.hashicorp.com/terraform/cli/config/config-file#filesystem_mirror>defined via the CLI configuration file</a>. In contrast, once <a href=https://developer.hashicorp.com/terraform/cli/config/config-file#implied-local-mirror-directories>implicit filesystem mirrors</a> are created by a user they are discovered and used by Terraform automatically.</p><p>Filesystem mirrors require providers&rsquo; files to be saved with specific paths for them to work correctly. To help with this, you can use the <a href=https://developer.hashicorp.com/terraform/cli/commands/providers/mirror><code>terraform providers mirror</code> command</a> to download a published provider to your local filesystem with the required file path.</p><p>Implied filesystem mirrors require manual cleanup if you want to revert back to using providers downloaded from the public Registry, and if an implied filesystem mirror is in place that a user is unaware of it can lead to confusing behaviour that is hard to debug. Other disadvantages compared to developer overrides include:</p><ul><li>No warning in terminal output letting you know when your local files are in use.</li><li>Need to set a version number for your local version of the provider which is compatible with your Terraform configuration&rsquo;s version constraints</li><li>Setup and cleanup required each time you swap to and from using them</li></ul><h3 id=possible-problems>Possible problems
<a class=anchor href=#possible-problems>#</a></h3><p>Filesystem mirrors (particularly &ldquo;<a href=https://developer.hashicorp.com/terraform/cli/config/config-file#implied-local-mirror-directories><em>implicit</em> filesystem mirrors</a>&rdquo;) are used automatically by Terraform, so can interfere with the expected behaviour of Terraform if you&rsquo;re not aware they&rsquo;re present.</p><p>To stop using the filesystem mirror, you can run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>rm -rf ~/.terraform.d/plugins/registry.terraform.io/hashicorp/
</span></span></code></pre></div><p>Another way to debug this is to run a Terraform command with the <code>TF_LOG</code> environment variable set to <code>TRACE</code> . Then, look for a log line similar to the below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>TRACE<span style=color:#f92672>]</span> getproviders.SearchLocalDirectory: found registry.terraform.io/hashicorp/google vX.X.X <span style=color:#66d9ef>for</span> darwin_arm64 at /Users/UserName/.terraform.d/plugins/registry.terraform.io/hashicorp/google/xxx
</span></span></code></pre></div></div></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/22e76ac59da09ed0a33a598979c69481baa51965 title='Last modified by Thomas Rodgers | July 25, 2023' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 25, 2023</span></a></div><div><a class="flex align-center" href="https://github.com/hashicorp/terraform-provider-google/issues/new?assignees=&labels=technical-debt,documentation&projects=&title=MM%20docsite%20issue%20in%20content/develop%2frun-tests.md&template=11_developer_productivity.md" target=_blank rel=noopener><img src=/magic-modules/report.svg class=book-icon alt=Edit>
<span>Report documentation issue</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/develop/run-tests.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#before-you-begin>Before you begin</a></li><li><a href=#run-automated-tests>Run automated tests</a></li><li><a href=#optional-test-with-different-terraform-versions>Optional: Test with different <code>terraform</code> versions</a></li><li><a href=#optional-test-manually>Optional: Test manually</a><ul><li><a href=#build-provider>Build provider</a></li></ul></li></ul></nav></div></aside></main></body></html>