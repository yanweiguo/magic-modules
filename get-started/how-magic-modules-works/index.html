<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="How Magic Modules works # Magic Modules can be thought of as a source of truth for how to map a GCP API resource representation to a Terraform resource representation. Magic Modules uses that mapping (and additional handwritten code where necessary) to generate &ldquo;downstream&rdquo; repositories - in particular, the Terraform providers for Google Platform: google (or TPG) and google-beta (or TPGB).
Generation of the downstream repositories happens for every new commit in a PR (to a temporary branch owned by the modular-magician robot user) and on every merge into the main branch (to the main branch of downstreams)."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="How Magic Modules works"><meta property="og:description" content="How Magic Modules works # Magic Modules can be thought of as a source of truth for how to map a GCP API resource representation to a Terraform resource representation. Magic Modules uses that mapping (and additional handwritten code where necessary) to generate &ldquo;downstream&rdquo; repositories - in particular, the Terraform providers for Google Platform: google (or TPG) and google-beta (or TPGB).
Generation of the downstream repositories happens for every new commit in a PR (to a temporary branch owned by the modular-magician robot user) and on every merge into the main branch (to the main branch of downstreams)."><meta property="og:type" content="article"><meta property="og:url" content="https://googlecloudplatform.github.io/magic-modules/get-started/how-magic-modules-works/"><meta property="article:section" content="get-started"><meta property="article:modified_time" content="2023-06-14T11:58:54-07:00"><title>How Magic Modules works | Magic Modules</title><link rel=manifest href=/magic-modules/manifest.json><link rel=icon href=/magic-modules/favicon.png type=image/x-icon><link rel=stylesheet href=/magic-modules/book.min.c58292d36b18b675680ab9baea2029204537b839ea72f258746ec0f32ce8d6c8.css integrity="sha256-xYKS02sYtnVoCrm66iApIEU3uDnqcvJYdG7A8yzo1sg=" crossorigin=anonymous><script defer src=/magic-modules/flexsearch.min.js></script>
<script defer src=/magic-modules/en.search.min.2f653af129452131d2b57b9c0e9fa9ec37004674da72f2dff61bdc033552be6e.js integrity="sha256-L2U68SlFITHStXucDp+p7DcARnTacvLf9hvcAzVSvm4=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/magic-modules/><img src=/magic-modules/magic-modules.svg alt=Logo><span>Magic Modules</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/magic-modules/>Overview</a></li></ul><ul><li><span>Get started</span><ul><li><a href=/magic-modules/get-started/generate-providers/>Generate the providers</a></li><li><a href=/magic-modules/get-started/how-magic-modules-works/ class=active>How Magic Modules works</a></li><li><a href=/magic-modules/get-started/run-provider-tests/>Run provider tests</a></li><li><a href=/magic-modules/get-started/use-built-provider/>Use built provider</a></li><li><a href=/magic-modules/get-started/contributing/>Contributing</a></li><li><a href=/magic-modules/get-started/provider-documentation/>Provider documentation</a></li></ul></li><li><span>Develop</span><ul><li><a href=/magic-modules/develop/add-mmv1-resource/>Add an MMv1 resource</a></li><li><a href=/magic-modules/develop/add-mmv1-iam/>Add MMv1 IAM resources</a></li><li><a href=/magic-modules/develop/add-mmv1-test/>Add an MMv1 test</a></li><li><a href=/magic-modules/develop/mmv1-resource-documentation/>Add and update MMv1 resource documentation</a></li><li><a href=/magic-modules/develop/update-handwritten-resource/>Update a handwritten resource</a></li><li><a href=/magic-modules/develop/add-handwritten-test/>Add a handwritten test</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource/>Add a handwritten datasource</a></li><li><a href=/magic-modules/develop/add-handwritten-iam/>Add handwritten IAM resources</a></li><li><a href=/magic-modules/develop/update-handwritten-documentation/>Update handwritten provider documentation</a></li><li><a href=/magic-modules/develop/add-handwritten-datasource-documentation/>Add documentation for a handwritten data source</a></li></ul></li><li><a href=/magic-modules/best-practices/>Best practices</a><ul></ul></li><li><span>Contribute</span><ul><li><a href=/magic-modules/contribute/release-notes/>Write release notes</a></li></ul></li><li><span>Reference</span><ul><li><a href=/magic-modules/reference/make-commands/>make commands</a></li><li><a href=https://github.com/GoogleCloudPlatform/magic-modules/blob/main/mmv1/api/resource.rb target=_blank rel=noopener>ResourceName.yaml resource â†—</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/magic-modules/svg/menu.svg class=book-icon alt=Menu></label>
<strong>How Magic Modules works</strong>
<label for=toc-control><img src=/magic-modules/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#resource-types>Resource types</a><ul><li><a href=#mmv1>MMv1</a></li><li><a href=#handwritten>Handwritten</a></li><li><a href=#dcl-aka-tpgtools-maintenance-mode>DCL aka tpgtools (maintenance mode)</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=how-magic-modules-works>How Magic Modules works
<a class=anchor href=#how-magic-modules-works>#</a></h1><p>Magic Modules can be thought of as a source of truth for how to map a GCP API resource representation to a Terraform resource representation. Magic Modules uses that mapping (and additional handwritten code where necessary) to generate &ldquo;downstream&rdquo; repositories - in particular, the Terraform providers for Google Platform: <a href=https://github.com/hashicorp/terraform-provider-google><code>google</code></a> (or TPG) and <a href=https://github.com/hashicorp/terraform-provider-google-beta><code>google-beta</code></a> (or TPGB).</p><p>Generation of the downstream repositories happens for every new commit in a PR (to a temporary branch owned by the <a href=https://github.com/modular-magician/><code>modular-magician</code></a> robot user) and on every merge into the main branch (to the main branch of downstreams). Generation for PR commits allows contributors to manually examine the changes, as well as allowing automatic running of unit tests, acceptance tests, and automated checks such as breaking change detection.</p><h2 id=resource-types>Resource types
<a class=anchor href=#resource-types>#</a></h2><p>There are three types of resources supported by Magic Modules: MMv1, Handwritten, and DCL/tpgtools. These are described in more detail in the following sections.</p><h3 id=mmv1>MMv1
<a class=anchor href=#mmv1>#</a></h3><p>MMv1 is a Ruby-based code generator that implements Terraform Provider Google (TPG) resources from YAML specification files.</p><p>MMv1-generated resources like <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_address>google_compute_address</a> can be identified by looking in their <a href=https://github.com/hashicorp/terraform-provider-google/blob/main/google/resource_compute_address.go>Go source</a> for an <code>AUTO GENERATED CODE</code> header as well as a Type <code>MMv1</code>. MMv1-generated resources should have source code present under their product folders, like <a href=./products/compute>mmv1/products/compute</a> for the <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_address>google_compute_address</a> resource.</p><h3 id=handwritten>Handwritten
<a class=anchor href=#handwritten>#</a></h3><p>Handwritten resources like <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster>google_container_cluster</a> can be identified if they have source code present under the <a href=./resources>mmv1/third_party/terraform/resources</a> folder or by the absence of the <code>AUTO GENERATED CODE</code> header in their <a href=https://github.com/hashicorp/terraform-provider-google/blob/main/google/resource_container_cluster.go>Go source</a> in the downstream repositories. Handwritten datasources should be under the <a href=./data_sources>mmv1/third_party/terraform/data_sources</a> folder, tests under the <a href=./tests>mmv1/third_party/terraform/tests</a> folder and web documentation under the <a href=./website>mmv1/third_party/terraform/website</a> folder.</p><h3 id=dcl-aka-tpgtools-maintenance-mode>DCL aka tpgtools (maintenance mode)
<a class=anchor href=#dcl-aka-tpgtools-maintenance-mode>#</a></h3><p>DCL is a Go-based code generator that implements Terraform Provider Google (TPG) resources from YAML specification files.</p><p>DCL-generated resources like <a href=https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/bigquery_reservation_assignment>google_bigquery_reservation_assignment</a> can be identified by looking in their <a href=https://github.com/hashicorp/terraform-provider-google/blob/main/google/resource_bigquery_reservation_assignment.go>Go source</a> for an <code>AUTO GENERATED CODE</code> header as well as a Type <code>DCL</code>.</p><p>DCL is in maintenance mode, which means that new resources using the DCL are not being added.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/commit/77d732ee3b91c97ffe75d35382733747adfa7333 title='Last modified by Stephen Lewis (Burrows) | June 14, 2023' target=_blank rel=noopener><img src=/magic-modules/svg/calendar.svg class=book-icon alt=Calendar>
<span>June 14, 2023</span></a></div><div><a class="flex align-center" href=https://github.com/GoogleCloudPlatform/magic-modules/edit/main/docs/content/get-started/how-magic-modules-works.md target=_blank rel=noopener><img src=/magic-modules/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#resource-types>Resource types</a><ul><li><a href=#mmv1>MMv1</a></li><li><a href=#handwritten>Handwritten</a></li><li><a href=#dcl-aka-tpgtools-maintenance-mode>DCL aka tpgtools (maintenance mode)</a></li></ul></li></ul></nav></div></aside></main></body></html>